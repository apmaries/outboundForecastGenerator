<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--Removes Google Crawler from indexing page-->
    <meta name="robots" content="noindex" />
  </head>
  <body>
    <script>
      function authorize() {
        // OAuth configuration
        const clientId = "6f99c63b-3dfb-43cf-9792-a9b5c295d0ca";
        const redirectUri =
          "https://apmaries.github.io/outboundScheduler/wfm-outbound.html";

        // Get the domain of the parent page from the referrer
        const referrerDomain = document.referrer
          ? new URL(document.referrer).origin
          : "";

        // Strip subdomains and add the 'login' prefix
        const strippedDomain = referrerDomain.replace(
          /^[^\.]+\.([^.]+)\..*$/,
          "$1"
        );

        // Log the modified domain and the constructed authorization URL to the console for demonstration
        console.log(`OWH: App environment: ${strippedDomain}`);
        console.log(`OWH: Authorization URL:" ${authorizationUrl}`);

        // Set session storage
        sessionStorage.setItem("environment", strippedDomain);
        sessionStorage.setItem("clientId", clientId);

        const authorizationUrl = `https://login.${strippedDomain}/oauth/authorize?client_id=${clientId}&response_type=token&redirect_uri=${redirectUri}`;

        // Redirect the user to the authorization URL
        window.location.href = authorizationUrl;
      }

      // Call the authorize function when the page loads
      authorize();
    </script>
  </body>
</html>
